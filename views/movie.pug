extends layout.pug
include utils.pug
    //- .errors-container

block head
    title #{movie.name}
    link(rel='stylesheet' href='/stylesheets/movie.css')

    block nav
        include navBar.pug

block content
    h2 #{movie.name}
    div(class='movieBlock')
        img(src=`${movie.movieImg}` alt='movieImg' class='singleMovieImg')
    div(class='synopsis')
        label(class="movie_synopsis") #{movie.description}
    div(class="user_reviews")
        h4 User Reviews
        each review in reviews
            p #{review.User.username}: #{review.review}
                br
                if review.LikesDislike.rating == true
                    label(class='rating-label') Rating:
                    img(src='../images/thumbs-up.png', alt="thumbsUp" class='ratingImg')
                else
                    label(class='rating_label') Rating:
                    img(src='../images/thumbs-down.png', alt='thumbsDown' class='ratingImg')
            //- p Rating: #{review.LikesDislike.rating}
            if locals.authenticated
                if locals.user.id === review.user_id
                    form(method='post' action=`/movies/${review.id}/delete`)
                        button(class="delete_button") Delete Review
            //- p #{review.likeDislikes_id}
        //- if locals.authenticated
        //-     if locals.user.id === review.user_id
        //-         form(method='delete' action=) WORKING ON DELETE
        br
        if locals.authenticated
            form(method='post' action=`/movies/${movie.id}`)
                input(type='hidden' name='_csrf' value=token)
                br
                label(class='form_header') Post a review and leave a rating!
                br
                textarea(id='review' value=review name='review')
                br
                label(class="form_header") Did you like this movie?
                input(type='checkbox' value='true' name='likeDislike')
                br
                button(class='post_button') Post
        else
            br
            label Please login to post a review!
    //-insert other comments here
